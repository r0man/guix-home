{"id":"guix-home-08o","title":"Rename systems/container.scm to systems/agent.scm","description":"Single package/service definition for all agents. Export agent-home-environment and agent-home-profile.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T15:22:26.801800225+01:00","updated_at":"2026-01-24T15:27:54.365124355+01:00","closed_at":"2026-01-24T15:27:54.365124355+01:00","close_reason":"Renamed systems/container.scm to systems/agent.scm. Updated module name, added home-agent-service-type, exported agent-home-environment and agent-home-packages. Tested with guix home dry-run and REPL.","created_by":"Roman Scherer","dependencies":[{"issue_id":"guix-home-08o","depends_on_id":"guix-home-in9","type":"blocks","created_at":"2026-01-24T15:22:33.609851148+01:00","created_by":"Roman Scherer"}]}
{"id":"guix-home-0y4","title":"Fix IBus STT engine activation timeout","description":"## Root Cause Found\n\nThe timeout occurs because the engine crashes immediately during startup due to a **Babel 2.16.0 API incompatibility**.\n\n### Error\n```python\nFile sttwordstodigits.py:98\n  self._separator_symbol=Locale(self._current_locale.locale).number_symbols['decimal']\nKeyError: 'decimal'\n```\n\n### Cause\n- ibus-speech-to-text expects: `locale.number_symbols['decimal']`\n- Babel 2.16.0 returns: `locale.number_symbols['latn']['decimal']`\n\nThe code needs to be patched to use the new Babel API.\n\n### Fix Location\nThe fix needs to be in the guix-channel package definition for ibus-speech-to-text, adding a patch for `sttwordstodigits.py` line 98.\n\n### Files\n- ibus-speech-to-text package in https://github.com/r0man/guix-channel\n- `sttwordstodigits.py:98` in upstream","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-25T14:45:17.678666214+01:00","updated_at":"2026-01-25T14:57:20.76262313+01:00","created_by":"Roman Scherer","dependencies":[{"issue_id":"guix-home-0y4","depends_on_id":"guix-home-7ll","type":"blocks","created_at":"2026-01-25T14:57:33.666532041+01:00","created_by":"Roman Scherer"}]}
{"id":"guix-home-1d3","title":"The Daltons - Correct Architecture Implementation","description":"Implement proper container architecture: container runs guix home container (shepherd inside), Emacs runs as daemon via shepherd service, socket shared via XDG_RUNTIME_DIR, emacsclient from host connects to daemon. Files: 1 to create, 3 to modify.","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-24T16:37:45.312035223+01:00","updated_at":"2026-01-24T16:53:26.275905798+01:00","closed_at":"2026-01-24T16:53:26.275905798+01:00","close_reason":"All subtasks completed: daemon support added to home-emacs-service-type, agent.scm updated to use daemon mode, agent-container script created, shepherd services updated to use agent-container, container-run kept for backwards compatibility. Dry-run verification passed.","created_by":"Roman Scherer","dependencies":[{"issue_id":"guix-home-1d3","depends_on_id":"guix-home-cre","type":"blocks","created_at":"2026-01-24T16:38:33.934147474+01:00","created_by":"Roman Scherer"},{"issue_id":"guix-home-1d3","depends_on_id":"guix-home-790","type":"blocks","created_at":"2026-01-24T16:38:33.981443896+01:00","created_by":"Roman Scherer"},{"issue_id":"guix-home-1d3","depends_on_id":"guix-home-gw6","type":"blocks","created_at":"2026-01-24T16:38:34.021575668+01:00","created_by":"Roman Scherer"},{"issue_id":"guix-home-1d3","depends_on_id":"guix-home-1gp","type":"blocks","created_at":"2026-01-24T16:38:34.059473905+01:00","created_by":"Roman Scherer"},{"issue_id":"guix-home-1d3","depends_on_id":"guix-home-y9j","type":"blocks","created_at":"2026-01-24T16:38:34.09691493+01:00","created_by":"Roman Scherer"},{"issue_id":"guix-home-1d3","depends_on_id":"guix-home-9cb","type":"blocks","created_at":"2026-01-24T16:38:34.134892888+01:00","created_by":"Roman Scherer"}]}
{"id":"guix-home-1gp","title":"Update home-agent-service-type shepherd services","description":"Change from running container-emacs to running agent-container. Include herd actions for emacsclient/eval.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T16:38:04.06794768+01:00","updated_at":"2026-01-24T16:51:56.300160776+01:00","closed_at":"2026-01-24T16:51:56.300160776+01:00","close_reason":"Updated home-agent-shepherd-services to use agent-container instead of container-emacs. Added agent-container to deployed files. Added AGENT_NAME environment variable for each agent.","created_by":"Roman Scherer","dependencies":[{"issue_id":"guix-home-1gp","depends_on_id":"guix-home-gw6","type":"blocks","created_at":"2026-01-24T16:38:23.464351515+01:00","created_by":"Roman Scherer"}]}
{"id":"guix-home-1vb","title":"Create ibus.scm service module","description":"Create modules/r0man/guix/home/ibus.scm with env vars, packages, and Shepherd service","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-25T13:22:28.379670325+01:00","updated_at":"2026-01-25T13:25:41.218592948+01:00","closed_at":"2026-01-25T13:25:41.218592948+01:00","close_reason":"Created ibus.scm with home-ibus-service-type providing Shepherd service, environment variables, and packages","created_by":"Roman Scherer"}
{"id":"guix-home-2q2","title":"Update StumpWM config","description":"Keep named groups (Emacs=1, Web=2, Slack=7, Logs=8, Top=9). Add numbered groups 3-6 for agents (jack, joe, william, averell). Bind emacsclient-agent and claude-agent to keys.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T15:22:27.524292703+01:00","updated_at":"2026-01-24T15:31:56.127142151+01:00","closed_at":"2026-01-24T15:31:56.127142151+01:00","close_reason":"Updated StumpWM config with agent keymap. Added key bindings: s-t A for agent submenu (c=claude-agent, e=emacsclient-agent, s=agent-status, j/J/w/a for direct agent access by name). Groups 3-6 already mapped to Dalton agents via frame preferences.","created_by":"Roman Scherer","dependencies":[{"issue_id":"guix-home-2q2","depends_on_id":"guix-home-4m4","type":"blocks","created_at":"2026-01-24T15:22:34.296641986+01:00","created_by":"Roman Scherer"}]}
{"id":"guix-home-4m4","title":"Create agent scripts","description":"Create agent-for-group (centralized group→agent mapping), agent-ensure (start agent on-demand if not running), agent-exec (run command in agent container), agent-status (show all agent statuses), agent-restart (restart an agent), emacsclient-agent (connect to agent's Emacs), claude-agent (run Claude in agent container).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T15:22:27.163179242+01:00","updated_at":"2026-01-24T15:31:00.693241989+01:00","closed_at":"2026-01-24T15:31:00.693241989+01:00","close_reason":"Created 6 agent scripts: agent-for-group (group→agent mapping), agent-ensure (start on-demand), agent-exec (run command in container), agent-status (show statuses), emacsclient-agent (connect to agent's Emacs), claude-agent (run Claude in container). Updated home-agent-service-type to deploy scripts via home-files-service-type extension. Tested with guix home dry-run.","created_by":"Roman Scherer","dependencies":[{"issue_id":"guix-home-4m4","depends_on_id":"guix-home-08o","type":"blocks","created_at":"2026-01-24T15:22:33.962437516+01:00","created_by":"Roman Scherer"}]}
{"id":"guix-home-790","title":"Update systems/agent.scm","description":"Configure the emacs service with daemon mode enabled (daemon? #t). AGENT_NAME is read at runtime by the shepherd service inside the container.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T16:37:54.577934447+01:00","updated_at":"2026-01-24T16:50:10.939599606+01:00","closed_at":"2026-01-24T16:50:10.939599606+01:00","close_reason":"Configured home-emacs-service-type with daemon mode enabled (daemon? #t) in agent.scm. The default daemon-name 'server' is used.","created_by":"Roman Scherer","dependencies":[{"issue_id":"guix-home-790","depends_on_id":"guix-home-cre","type":"blocks","created_at":"2026-01-24T16:38:20.667703476+01:00","created_by":"Roman Scherer"}]}
{"id":"guix-home-7ll","title":"Patch ibus-speech-to-text for Babel 2.16.0 compatibility","description":"## Problem\n\nibus-speech-to-text 0.4.0 is incompatible with Babel 2.16.0.\n\n### Error\n```python\nFile sttwordstodigits.py:98\n  self._separator_symbol=Locale(self._current_locale.locale).number_symbols['decimal']\nKeyError: 'decimal'\n```\n\n### Fix Required\n\nPatch `sttwordstodigits.py` line 98:\n```python\n# Old (broken with Babel 2.16.0):\nself._separator_symbol=Locale(self._current_locale.locale).number_symbols['decimal']\n\n# New (works with Babel 2.16.0):\nself._separator_symbol=Locale(self._current_locale.locale).number_symbols['latn']['decimal']\n```\n\n### Implementation\n\n1. Create a patch file in guix-channel\n2. Add the patch to the ibus-speech-to-text package definition\n3. Rebuild and test\n\n### Repository\nhttps://github.com/r0man/guix-channel","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-25T14:57:25.218649663+01:00","updated_at":"2026-01-25T14:57:32.82355923+01:00","created_by":"Roman Scherer"}
{"id":"guix-home-9cb","title":"Add agent-container to deployed files","description":"Add agent-container script to home-agent-files in modules/r0man/guix/home/agent.scm.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T16:38:13.664011382+01:00","updated_at":"2026-01-24T16:52:32.657746953+01:00","closed_at":"2026-01-24T16:52:32.657746953+01:00","close_reason":"agent-container was already added to home-agent-files in agent.scm when completing guix-home-1gp","created_by":"Roman Scherer","dependencies":[{"issue_id":"guix-home-9cb","depends_on_id":"guix-home-y9j","type":"blocks","created_at":"2026-01-24T16:38:26.272022571+01:00","created_by":"Roman Scherer"}]}
{"id":"guix-home-a73","title":"The Daltons - Multi-Agent Home Configuration","description":"Four agent containers named after the Dalton brothers (Jack, Joe, William, Averell), each running an Emacs daemon. Workspaces in StumpWM map to agents, and emacsclient-agent auto-connects to the right one based on current workspace. All agents share a single profile for fast builds. Files: 8 to create, 3 to modify, 4 to delete.","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-24T15:22:16.502805294+01:00","updated_at":"2026-01-24T15:34:39.931911109+01:00","closed_at":"2026-01-24T15:34:39.931911109+01:00","close_reason":"Epic complete. Created multi-agent home configuration for the Daltons (Jack, Joe, William, Averell). Includes:\n- home/agent.scm: Service type with socket dir creation and script deployment\n- systems/agent.scm: Renamed from container.scm, shared environment for all agents\n- 6 agent scripts: agent-for-group, agent-ensure, agent-exec, agent-status, emacsclient-agent, claude-agent\n- StumpWM config: Agent keymap (s-t A) with key bindings\n- precision.scm: Integrated home-agent-service-type\nAll files tested with guix home dry-run.","created_by":"Roman Scherer","dependencies":[{"issue_id":"guix-home-a73","depends_on_id":"guix-home-in9","type":"blocks","created_at":"2026-01-24T15:22:39.344094308+01:00","created_by":"Roman Scherer"},{"issue_id":"guix-home-a73","depends_on_id":"guix-home-08o","type":"blocks","created_at":"2026-01-24T15:22:39.3778925+01:00","created_by":"Roman Scherer"},{"issue_id":"guix-home-a73","depends_on_id":"guix-home-4m4","type":"blocks","created_at":"2026-01-24T15:22:39.408865459+01:00","created_by":"Roman Scherer"},{"issue_id":"guix-home-a73","depends_on_id":"guix-home-2q2","type":"blocks","created_at":"2026-01-24T15:22:39.444216883+01:00","created_by":"Roman Scherer"},{"issue_id":"guix-home-a73","depends_on_id":"guix-home-et0","type":"blocks","created_at":"2026-01-24T15:22:39.479580949+01:00","created_by":"Roman Scherer"}]}
{"id":"guix-home-amv","title":"Add IBus service to precision.scm","description":"Import (r0man guix home ibus) and add (service home-ibus-service-type) to services","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-25T13:22:29.239475764+01:00","updated_at":"2026-01-25T13:26:21.202804605+01:00","closed_at":"2026-01-25T13:26:21.202804605+01:00","close_reason":"Added home-ibus-service-type to precision.scm services list","created_by":"Roman Scherer","dependencies":[{"issue_id":"guix-home-amv","depends_on_id":"guix-home-1vb","type":"blocks","created_at":"2026-01-25T13:22:38.00795729+01:00","created_by":"Roman Scherer"}]}
{"id":"guix-home-cre","title":"Add daemon support to home-emacs-service-type","description":"Extend the existing configuration record with daemon fields (daemon?, daemon-name) and add shepherd service extension for Emacs daemon mode in modules/r0man/guix/home/emacs.scm.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T16:37:49.93009317+01:00","updated_at":"2026-01-24T16:49:31.355647856+01:00","closed_at":"2026-01-24T16:49:31.355647856+01:00","close_reason":"Implemented daemon support in home-emacs-service-type: added daemon? and daemon-name fields to configuration record, added shepherd service extension that creates emacs-\u003cname\u003e shepherd service when enabled","created_by":"Roman Scherer"}
{"id":"guix-home-et0","title":"Update precision.scm","description":"Add home-agent-profile-service-type (once). Add four home-agent-service-type instances for jack, joe, william, averell.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T15:22:27.885263822+01:00","updated_at":"2026-01-24T15:34:24.083838773+01:00","closed_at":"2026-01-24T15:34:24.083838773+01:00","close_reason":"Added home-agent-service-type to precision.scm. Updated container-home.scm to use renamed agent module and added home-agent-home-service-type alias. Both precision.scm and agent.scm dry-run successfully.","created_by":"Roman Scherer","dependencies":[{"issue_id":"guix-home-et0","depends_on_id":"guix-home-2q2","type":"blocks","created_at":"2026-01-24T15:22:34.650868652+01:00","created_by":"Roman Scherer"}]}
{"id":"guix-home-gw6","title":"Create agent-container script","description":"New script that uses guix home container instead of guix shell --container. Runs a full home environment with shepherd inside.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T16:37:59.35283937+01:00","updated_at":"2026-01-24T16:51:07.25291039+01:00","closed_at":"2026-01-24T16:51:07.25291039+01:00","close_reason":"Created agent-container script that uses 'guix home container' instead of 'guix shell --container'. The script runs the full home environment with shepherd inside.","created_by":"Roman Scherer","dependencies":[{"issue_id":"guix-home-gw6","depends_on_id":"guix-home-790","type":"blocks","created_at":"2026-01-24T16:38:21.904231048+01:00","created_by":"Roman Scherer"}]}
{"id":"guix-home-in9","title":"Create home/agent.scm service module","description":"Define home-agent-configuration record (name, profile). Define home-agent-service-type with shepherd extension. Define home-agent-profile-service-type for shared profile symlink. Handle socket directory creation, container startup.","notes":"Created modules/r0man/guix/home/agent.scm with:\n- home-agent-configuration record (name, socket-dir, profile fields)\n- home-agent-service-type with home-activation-service-type extension\n- home-agent-activation creates socket directory at XDG_RUNTIME_DIR/emacs-NAME\n- %dalton-agents list of Dalton brother agent names\n- Tested with guix home dry-run - module loads and service type works","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T15:22:26.455103182+01:00","updated_at":"2026-01-24T15:26:20.26234525+01:00","closed_at":"2026-01-24T15:26:20.26234525+01:00","close_reason":"Created modules/r0man/guix/home/agent.scm with home-agent-configuration record, home-agent-service-type, and activation extension for socket directory creation. Module tested successfully with guix home dry-run.","created_by":"Roman Scherer"}
{"id":"guix-home-khj","title":"IBus Home Service for Guix","description":"Create Guix Home service module for IBus: sets env vars, installs packages, starts ibus-daemon via Shepherd. Files: 3 to modify.","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-25T13:22:19.700763872+01:00","updated_at":"2026-01-25T13:27:04.051901714+01:00","closed_at":"2026-01-25T13:27:04.051901714+01:00","close_reason":"IBus Home Service implemented: ibus.scm module with Shepherd service, environment variables, and packages; integrated into precision.scm","created_by":"Roman Scherer","dependencies":[{"issue_id":"guix-home-khj","depends_on_id":"guix-home-1vb","type":"blocks","created_at":"2026-01-25T13:22:38.075911267+01:00","created_by":"Roman Scherer"},{"issue_id":"guix-home-khj","depends_on_id":"guix-home-amv","type":"blocks","created_at":"2026-01-25T13:22:38.113096528+01:00","created_by":"Roman Scherer"},{"issue_id":"guix-home-khj","depends_on_id":"guix-home-ybe","type":"blocks","created_at":"2026-01-25T13:22:38.151079869+01:00","created_by":"Roman Scherer"}]}
{"id":"guix-home-lbv","title":"Investigate ibus-daemon child process environment inheritance","description":"## Problem\n\nWhen ibus-daemon spawns the ibus-engine-stt process, it may not be passing all required environment variables correctly.\n\n## Background\n\nThe shepherd service sets `IBUS_COMPONENT_PATH` and `GST_PLUGIN_PATH` for the ibus-daemon process. However, when ibus-daemon spawns child processes (engines), it's unclear if these environment variables are inherited.\n\n## Current Setup\n\nShepherd service passes environment via `fork+exec-command`:\n```scheme\n#:environment-variables\n(cons* (string-append \"IBUS_COMPONENT_PATH=\" component-path)\n       (string-append \"GST_PLUGIN_PATH=\" gst-plugin-path)\n       ...)\n```\n\n## Investigation Needed\n\n1. Check if ibus-daemon uses D-Bus activation or direct exec for engines\n2. Verify environment variables are passed to child processes\n3. If D-Bus activation is used, environment may need to be set differently\n4. Consider wrapper script approach if needed\n\n## Verification\n\nWhen engine is started manually with correct environment, it works:\n```bash\nGST_PLUGIN_PATH=~/.guix-home/profile/lib/gstreamer-1.0 \\\nIBUS_COMPONENT_PATH=~/.guix-home/profile/share/ibus/component \\\nibus-engine-stt --ibus --debug\n```\n\n## Files\n\n- `/home/r0man/workspace/guix-home/modules/r0man/guix/home/ibus.scm`\n- `/home/r0man/.guix-home/profile/share/ibus/component/stt.xml`","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-25T14:45:26.862026589+01:00","updated_at":"2026-01-25T14:57:12.008301517+01:00","closed_at":"2026-01-25T14:57:12.008301517+01:00","close_reason":"Investigation complete: Environment variables ARE correctly inherited. The actual issue is a Babel 2.16.0 API incompatibility in ibus-speech-to-text. The code expects locale.number_symbols['decimal'] but Babel 2.16.0 returns locale.number_symbols['latn']['decimal']. This is a bug in the ibus-speech-to-text package, not an environment issue.","created_by":"Roman Scherer"}
{"id":"guix-home-nw8","title":"Create wrapper script for ibus-engine-stt with environment","description":"## Proposal\n\nCreate a wrapper script that sets required environment variables before launching ibus-engine-stt. Modify the IBus component XML to use this wrapper instead of directly calling the engine binary.\n\n## Rationale\n\nIf ibus-daemon doesn't properly inherit environment variables to child processes, a wrapper script can ensure the engine always starts with correct environment.\n\n## Implementation\n\n1. Create wrapper script in guix home files:\n```bash\n#!/bin/sh\nexport GST_PLUGIN_PATH=\"$HOME/.guix-home/profile/lib/gstreamer-1.0\"\nexport IBUS_COMPONENT_PATH=\"$HOME/.guix-home/profile/share/ibus/component\"\nexec /path/to/ibus-engine-stt \"$@\"\n```\n\n2. Create custom component XML that points to wrapper\n3. Set IBUS_COMPONENT_PATH to custom location with modified XML\n\n## Alternative\n\nPatch ibus-speech-to-text package to include environment setup in the engine itself.\n\n## Depends On\n\n- guix-home-lbv (Investigate environment inheritance)\n\n## Files\n\n- `/home/r0man/workspace/guix-home/modules/r0man/guix/home/ibus.scm`","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-25T14:45:34.481105538+01:00","updated_at":"2026-01-25T14:57:45.207856639+01:00","closed_at":"2026-01-25T14:57:45.207856639+01:00","close_reason":"Not needed. Investigation (guix-home-lbv) found environment variables ARE correctly inherited. The actual problem is a Babel 2.16.0 API incompatibility in ibus-speech-to-text, which requires a code patch (guix-home-7ll), not a wrapper script.","created_by":"Roman Scherer","dependencies":[{"issue_id":"guix-home-nw8","depends_on_id":"guix-home-lbv","type":"blocks","created_at":"2026-01-25T14:45:43.875512531+01:00","created_by":"Roman Scherer"}]}
{"id":"guix-home-y9j","title":"Keep container-run for backwards compatibility","description":"Keep container-run as-is for ad-hoc FHS container usage. The new architecture doesn't depend on it.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T16:38:09.123105133+01:00","updated_at":"2026-01-24T16:52:16.753968939+01:00","closed_at":"2026-01-24T16:52:16.753968939+01:00","close_reason":"container-run is already deployed via home-emacs-files in emacs.scm. No changes needed - it remains available for ad-hoc FHS container usage alongside the new agent-container script.","created_by":"Roman Scherer","dependencies":[{"issue_id":"guix-home-y9j","depends_on_id":"guix-home-1gp","type":"blocks","created_at":"2026-01-24T16:38:24.771211748+01:00","created_by":"Roman Scherer"}]}
{"id":"guix-home-ybe","title":"Remove IBus packages from packages.scm","description":"Remove ibus and ibus-speech-to-text from packages-base (now managed by service)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-25T13:22:30.250003347+01:00","updated_at":"2026-01-25T13:26:56.174645734+01:00","closed_at":"2026-01-25T13:26:56.174645734+01:00","close_reason":"Removed ibus and ibus-speech-to-text from packages-base since they are now provided by home-ibus-service-type","created_by":"Roman Scherer","dependencies":[{"issue_id":"guix-home-ybe","depends_on_id":"guix-home-amv","type":"blocks","created_at":"2026-01-25T13:22:38.041217095+01:00","created_by":"Roman Scherer"}]}
